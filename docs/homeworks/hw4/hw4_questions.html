<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rainie Xie">
<meta name="dcterms.date" content="2024-05-29">

<title>Rainie website - Key Drivers Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Rainie website</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html"> 
<span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../homeworks.html"> 
<span class="menu-text">Homeworks</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  </ul></li>
  <li><a href="#analysis-of-each-metric" id="toc-analysis-of-each-metric" class="nav-link" data-scroll-target="#analysis-of-each-metric">Analysis of Each Metric</a>
  <ul class="collapse">
  <li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">Pearson Correlation</a></li>
  <li><a href="#standardized-regression-coefficients" id="toc-standardized-regression-coefficients" class="nav-link" data-scroll-target="#standardized-regression-coefficients">Standardized Regression Coefficients</a></li>
  <li><a href="#usefulness" id="toc-usefulness" class="nav-link" data-scroll-target="#usefulness">Usefulness</a></li>
  <li><a href="#shapley-values-for-linear-regression" id="toc-shapley-values-for-linear-regression" class="nav-link" data-scroll-target="#shapley-values-for-linear-regression">Shapley Values for Linear Regression</a></li>
  <li><a href="#johnsons-relative-weights" id="toc-johnsons-relative-weights" class="nav-link" data-scroll-target="#johnsons-relative-weights">Johnson’s Relative Weights</a></li>
  <li><a href="#mean-decrease-in-gini-from-random-forest" id="toc-mean-decrease-in-gini-from-random-forest" class="nav-link" data-scroll-target="#mean-decrease-in-gini-from-random-forest">Mean Decrease in Gini from Random Forest</a></li>
  <li><a href="#feature-importance-from-xgboost" id="toc-feature-importance-from-xgboost" class="nav-link" data-scroll-target="#feature-importance-from-xgboost">Feature Importance from XGBoost</a></li>
  </ul></li>
  <li><a href="#combined-analysis-and-conclusion" id="toc-combined-analysis-and-conclusion" class="nav-link" data-scroll-target="#combined-analysis-and-conclusion">Combined Analysis and Conclusion</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Key Drivers Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rainie Xie </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 29, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>This post implements a few measure of variable importance, interpreted as a key drivers analysis, for certain aspects of a payment card on customer satisfaction with that payment card.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>We aim to identify and interpret the importance of various features using several metrics: Pearson Correlation, Standardized Regression Coefficients, Usefulness (Incremental R²), Shapley Values for Linear Regression, Johnson’s Relative Weights, Mean Decrease in Gini from Random Forest, and Feature Importance from XGBoost.</p>
<p>Understanding these key drivers will help us to gain insights into which factors most significantly affect customer satisfaction and how different statistical methods can provide unique perspectives on feature importance.</p>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<div id="47e07432" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'./data_for_drivers_analysis.csv'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the dataset</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.describe())</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.isnull().<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             brand            id  satisfaction        trust        build  \
count  2553.000000   2553.000000   2553.000000  2553.000000  2553.000000   
mean      4.857423   8931.480611      3.386604     0.549550     0.461810   
std       2.830096   5114.287849      1.172006     0.497636     0.498637   
min       1.000000     88.000000      1.000000     0.000000     0.000000   
25%       3.000000   4310.000000      3.000000     0.000000     0.000000   
50%       4.000000   8924.000000      4.000000     1.000000     0.000000   
75%       6.000000  13545.000000      4.000000     1.000000     1.000000   
max      10.000000  18088.000000      5.000000     1.000000     1.000000   

           differs         easy    appealing    rewarding      popular  \
count  2553.000000  2553.000000  2553.000000  2553.000000  2553.000000   
mean      0.334508     0.536232     0.451234     0.451234     0.536232   
std       0.471911     0.498783     0.497714     0.497714     0.498783   
min       0.000000     0.000000     0.000000     0.000000     0.000000   
25%       0.000000     0.000000     0.000000     0.000000     0.000000   
50%       0.000000     1.000000     0.000000     0.000000     1.000000   
75%       1.000000     1.000000     1.000000     1.000000     1.000000   
max       1.000000     1.000000     1.000000     1.000000     1.000000   

           service       impact  
count  2553.000000  2553.000000  
mean      0.467293     0.330983  
std       0.499027     0.470659  
min       0.000000     0.000000  
25%       0.000000     0.000000  
50%       0.000000     0.000000  
75%       1.000000     1.000000  
max       1.000000     1.000000  
brand           0
id              0
satisfaction    0
trust           0
build           0
differs         0
easy            0
appealing       0
rewarding       0
popular         0
service         0
impact          0
dtype: int64</code></pre>
</div>
</div>
<ul>
<li><strong>Variables:</strong>
<ul>
<li><code>brand</code>: Identifier for the brand.</li>
<li><code>id</code>: Identifier for the customer.</li>
<li><code>satisfaction</code>: Customer satisfaction rating.</li>
<li><code>trust</code>: Trust in the brand.</li>
<li><code>build</code>: Helps build credit quickly.</li>
<li><code>differs</code>: Is different from other cards.</li>
<li><code>easy</code>: Is easy to use.</li>
<li><code>appealing</code>: Has appealing benefits or rewards.</li>
<li><code>rewarding</code>: Rewards for responsible usage.</li>
<li><code>popular</code>: Is used by a lot of people.</li>
<li><code>service</code>: Provides outstanding customer service.</li>
<li><code>impact</code>: Makes a difference in the customer’s life.</li>
</ul></li>
</ul>
<p>The dataset contains various features related to customer satisfaction with a payment card. Each row represents a customer, and each column represents a feature that may influence their satisfaction level. The features include trust, build credit quickly, different from other cards, easy to use, appealing benefits, rewarding for responsible usage, used by many people, outstanding customer service, and making a difference in life.</p>
<section id="visualization" class="level3">
<h3 class="anchored" data-anchor-id="visualization">Visualization</h3>
<p>Distribution of Satisfaction Scores</p>
<div id="80ebb837" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>sns.histplot(data[<span class="st">'satisfaction'</span>], kde<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Customer Satisfaction'</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Satisfaction'</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="hw4_questions_files/figure-html/cell-3-output-1.png" width="816" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The histogram shows a relatively normal distribution of satisfaction scores, with the majority of scores clustering around 3 and 4.</p>
</section>
</section>
<section id="analysis-of-each-metric" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-each-metric">Analysis of Each Metric</h2>
<section id="pearson-correlation" class="level3">
<h3 class="anchored" data-anchor-id="pearson-correlation">Pearson Correlation</h3>
<p>Pearson correlation measures the linear relationship between two variables. It ranges from -1 to 1, where values closer to 1 indicate a strong positive relationship, values closer to -1 indicate a strong negative relationship, and values around 0 indicate no linear relationship.</p>
<div id="7333720f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature selection</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [<span class="st">'trust'</span>, <span class="st">'build'</span>, <span class="st">'differs'</span>, <span class="st">'easy'</span>, <span class="st">'appealing'</span>, <span class="st">'rewarding'</span>, <span class="st">'popular'</span>, <span class="st">'service'</span>, <span class="st">'impact'</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data[features]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">'satisfaction'</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pearson correlations</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>correlations <span class="op">=</span> data.corr()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>pearson_corr <span class="op">=</span> correlations[<span class="st">'satisfaction'</span>][features]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the correlations</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>normalized_corr <span class="op">=</span> (pearson_corr <span class="op">/</span> pearson_corr.<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>normalized_corr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>trust        13.283356
build         9.968574
differs       9.600014
easy         11.064100
appealing    10.804975
rewarding    10.107052
popular       8.905177
service      13.044017
impact       13.222734
Name: satisfaction, dtype: float64</code></pre>
</div>
</div>
<p>The Pearson correlation coefficients for each feature with respect to customer satisfaction are calculated to understand which features have the strongest linear relationships with satisfaction.</p>
<ul>
<li><strong>trust</strong>,<strong>impact</strong> and <strong>service</strong> show relatively strong positive correlations with customer satisfaction, indicating that as these factors increase, so does satisfaction.</li>
<li><strong>popular</strong> and <strong>differs</strong> also have positive correlations but are less strong.</li>
</ul>
</section>
<section id="standardized-regression-coefficients" class="level3">
<h3 class="anchored" data-anchor-id="standardized-regression-coefficients">Standardized Regression Coefficients</h3>
<p>Standardized regression coefficients are used in regression analysis to compare the relative importance of different predictors. They are scaled to have a mean of zero and a standard deviation of one, making them comparable across different units of measurement.</p>
<div id="a0cde01e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardizing the features</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the linear regression model</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>model.fit(X_scaled, y)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract standardized regression coefficients (betas)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>standardized_coefficients <span class="op">=</span> model.coef_</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>normalized_coefficients <span class="op">=</span> (np.<span class="bu">abs</span>(standardized_coefficients)<span class="op">/</span>np.<span class="bu">abs</span>(standardized_coefficients).<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame for better visualization</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>coefficients_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Feature'</span>: X.columns,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Standardized Coefficient'</span>: standardized_coefficients,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Normalized Coefficient'</span>: normalized_coefficients</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>coefficients_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Standardized Coefficient</th>
<th data-quarto-table-cell-role="th">Normalized Coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>trust</td>
<td>0.135635</td>
<td>25.280109</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>build</td>
<td>0.023411</td>
<td>4.363461</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>differs</td>
<td>0.032631</td>
<td>6.081798</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>easy</td>
<td>0.025744</td>
<td>4.798205</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>appealing</td>
<td>0.039647</td>
<td>7.389479</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>rewarding</td>
<td>0.005937</td>
<td>1.106526</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>popular</td>
<td>0.019470</td>
<td>3.628859</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>service</td>
<td>0.103573</td>
<td>19.304269</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>impact</td>
<td>0.150482</td>
<td>28.047294</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>These coefficients indicate how many standard deviations the dependent variable will change per standard deviation increase in the predictor variable.</p>
<ul>
<li><strong>impact</strong> and <strong>trust</strong> have the highest standardized coefficients, suggesting they are the most important predictors of customer satisfaction.</li>
<li><strong>rewarding</strong> and <strong>popular</strong> have relatively low standardized coefficients, indicating they are less influential.</li>
</ul>
</section>
<section id="usefulness" class="level3">
<h3 class="anchored" data-anchor-id="usefulness">Usefulness</h3>
<p>Usefulness measures the incremental contribution of each predictor to the R² value of the model. It helps in understanding how much additional variance in the dependent variable is explained by each predictor.</p>
<div id="322288d8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model R-squared</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>full_r2 <span class="op">=</span> model.score(X_scaled, y)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate usefulness (LMG values)</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>usefulness <span class="op">=</span> []</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature <span class="kw">in</span> <span class="bu">range</span>(X_scaled.shape[<span class="dv">1</span>]):</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    X_temp <span class="op">=</span> np.delete(X_scaled, feature, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    temp_model <span class="op">=</span> LinearRegression().fit(X_temp, y)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    temp_r2 <span class="op">=</span> temp_model.score(X_temp, y)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    usefulness.append(full_r2 <span class="op">-</span> temp_r2)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the usefulness values</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>usefulness_normalized <span class="op">=</span> (np.array(usefulness) <span class="op">/</span> <span class="bu">sum</span>(usefulness)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrames for better visualization</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>usefulness_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Feature'</span>: features,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Usefulness Value'</span>: usefulness_normalized</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>usefulness_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Usefulness Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>trust</td>
<td>31.517391</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>build</td>
<td>1.016743</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>differs</td>
<td>2.104285</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>easy</td>
<td>1.103478</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>appealing</td>
<td>2.713117</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>rewarding</td>
<td>0.060194</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>popular</td>
<td>0.780849</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>service</td>
<td>17.869775</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>impact</td>
<td>42.834168</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>A higher incremental R² indicates that the predictor adds significant explanatory power to the model.</p>
<ul>
<li><strong>impact</strong> and <strong>trust</strong> provide significant explanatory power to the model.</li>
<li><strong>rewarding</strong> and <strong>popular</strong> have minimal impact on the model’s explanatory power.</li>
</ul>
</section>
<section id="shapley-values-for-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="shapley-values-for-linear-regression">Shapley Values for Linear Regression</h3>
<p>Shapley values provide a fair distribution of the total gain in model performance among the features. It considers all possible combinations of features and averages the marginal contributions.</p>
<ul>
<li><strong>SHAP Library</strong>: Uses the SHAP library to calculate Shapley values, which is efficient and well-optimized for various machine learning models.</li>
</ul>
<div id="3c82f655" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the SHAP library's LinearExplainer for Shapley values approximation</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.LinearExplainer(model, X_scaled)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer.shap_values(X_scaled)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean absolute Shapley values for each feature and normalize</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>mean_abs_shap_values <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(shap_values), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>normalized_shap_values <span class="op">=</span> (mean_abs_shap_values <span class="op">/</span> mean_abs_shap_values.<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame for better visualization</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>shap_values_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Feature'</span>: X.columns,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Shapley Value'</span>: mean_abs_shap_values,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Normalized Shapley Value'</span>: normalized_shap_values</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>shap_values_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Shapley Value</th>
<th data-quarto-table-cell-role="th">Normalized Shapley Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>trust</td>
<td>0.136576</td>
<td>26.694012</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>build</td>
<td>0.023157</td>
<td>4.526070</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>differs</td>
<td>0.028857</td>
<td>5.640139</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>easy</td>
<td>0.025924</td>
<td>5.066851</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>appealing</td>
<td>0.039060</td>
<td>7.634243</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>rewarding</td>
<td>0.005861</td>
<td>1.145452</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>popular</td>
<td>0.019465</td>
<td>3.804387</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>service</td>
<td>0.102030</td>
<td>19.941906</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>impact</td>
<td>0.130708</td>
<td>25.546941</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<ul>
<li><strong>Manual Calculation</strong>: Implements a manual approach to calculate Shapley values by averaging over permutations, which provides a close approximation to the theoretical Shapley values.</li>
</ul>
<div id="b24e5377" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the features matrix X and the target vector y</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>X_matrix <span class="op">=</span> X.values</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>y_vector <span class="op">=</span> y.values</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> approximate_shapley_values_manual(X, y, n_samples<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    n_features <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    shapley_values <span class="op">=</span> np.zeros(n_features)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    random.seed(<span class="dv">42</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_features):</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        feature_contributions <span class="op">=</span> []</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Generate a random subset of features excluding the current feature</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>            subset <span class="op">=</span> random.sample([x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(n_features) <span class="cf">if</span> x <span class="op">!=</span> i], k<span class="op">=</span>random.randint(<span class="dv">0</span>, n_features<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>            subset_with_i <span class="op">=</span> subset <span class="op">+</span> [i]</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Fit model with subset without the feature</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> subset:</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                scaler_subset <span class="op">=</span> StandardScaler()</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>                X_subset <span class="op">=</span> scaler_subset.fit_transform(X[:, subset])</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                model_subset <span class="op">=</span> LinearRegression().fit(X_subset, y)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                r2_subset <span class="op">=</span> r2_score(y, model_subset.predict(X_subset))</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>                r2_subset <span class="op">=</span> <span class="dv">0</span>  <span class="co"># baseline R² with no features</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Fit model with subset with the feature</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>            scaler_subset_with_i <span class="op">=</span> StandardScaler()</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>            X_subset_with_i <span class="op">=</span> scaler_subset_with_i.fit_transform(X[:, subset_with_i])</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>            model_subset_with_i <span class="op">=</span> LinearRegression().fit(X_subset_with_i, y)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>            r2_subset_with_i <span class="op">=</span> r2_score(y, model_subset_with_i.predict(X_subset_with_i))</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate marginal contribution</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>            marginal_contribution <span class="op">=</span> r2_subset_with_i <span class="op">-</span> r2_subset</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>            feature_contributions.append(marginal_contribution)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate Shapley value for the feature</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        shapley_values[i] <span class="op">=</span> np.mean(feature_contributions)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> shapley_values</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate approximate Shapley values manually</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>shap_values_manual <span class="op">=</span> approximate_shapley_values_manual(X_matrix, y_vector)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the Shapley values to sum to 100%</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>normalized_shap_values_manual <span class="op">=</span> (shap_values_manual <span class="op">/</span> shap_values_manual.<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Map the Shapley values to the feature names and normalize to sum to 100%</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>shapley_values_manual_df <span class="op">=</span> pd.DataFrame({<span class="st">'Feature'</span>: X.columns, <span class="st">'Shapley Value'</span>: shap_values_manual, <span class="st">'Normalized Shapley Value'</span>: normalized_shap_values_manual})</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>shapley_values_manual_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Shapley Value</th>
<th data-quarto-table-cell-role="th">Normalized Shapley Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>trust</td>
<td>0.021209</td>
<td>19.547288</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>build</td>
<td>0.006640</td>
<td>6.119831</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>differs</td>
<td>0.006930</td>
<td>6.386692</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>easy</td>
<td>0.009254</td>
<td>8.528979</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>appealing</td>
<td>0.009916</td>
<td>9.139131</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>rewarding</td>
<td>0.007342</td>
<td>6.767128</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>popular</td>
<td>0.005680</td>
<td>5.234813</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>service</td>
<td>0.017968</td>
<td>16.560666</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>impact</td>
<td>0.023561</td>
<td>21.715472</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<ul>
<li><strong>impact</strong> and <strong>trust</strong> again emerge as significant contributors to the model.</li>
<li><strong>rewarding</strong> and <strong>popular</strong> contribute less significantly.</li>
</ul>
</section>
<section id="johnsons-relative-weights" class="level3">
<h3 class="anchored" data-anchor-id="johnsons-relative-weights">Johnson’s Relative Weights</h3>
<p>Johnson’s Relative Weights (also known as Johnson’s Epsilon) offer an approximation to Shapley values for linear regression by transforming the predictors into orthogonal components and assessing their contributions.</p>
<div id="8589655d" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> relativeImp <span class="im">import</span> relativeImp</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify outcome variable</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>yName <span class="op">=</span> <span class="st">'satisfaction'</span>  </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Johnson's Relative Weights using relativeImp</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>relative_weights <span class="op">=</span> relativeImp(data, outcomeName<span class="op">=</span>yName, driverNames<span class="op">=</span>features)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>relative_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">driver</th>
<th data-quarto-table-cell-role="th">rawRelaImpt</th>
<th data-quarto-table-cell-role="th">normRelaImpt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>trust</td>
<td>0.021623</td>
<td>19.835524</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>build</td>
<td>0.007217</td>
<td>6.620792</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>differs</td>
<td>0.007594</td>
<td>6.966081</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>easy</td>
<td>0.008982</td>
<td>8.239683</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>appealing</td>
<td>0.009099</td>
<td>8.346395</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>rewarding</td>
<td>0.006538</td>
<td>5.997431</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>popular</td>
<td>0.005878</td>
<td>5.392328</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>service</td>
<td>0.018134</td>
<td>16.635164</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>impact</td>
<td>0.023946</td>
<td>21.966601</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>These weights provide a measure of the relative importance of each feature in the context of a linear model.</p>
<ul>
<li><strong>impact</strong> and <strong>trust</strong> have the highest relative weights, confirming their significant role.</li>
<li><strong>rewarding</strong> and <strong>popular</strong> remain the least important.</li>
</ul>
</section>
<section id="mean-decrease-in-gini-from-random-forest" class="level3">
<h3 class="anchored" data-anchor-id="mean-decrease-in-gini-from-random-forest">Mean Decrease in Gini from Random Forest</h3>
<p>The Mean Decrease in Gini measures the importance of each feature in reducing the Gini impurity across all trees in the forest. It is specific to tree-based models like Random Forest.</p>
<div id="6161c290" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a Random Forest model</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>rf_model.fit(X, y)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate feature importances using the mean decrease in Gini coefficient</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>rf_feature_importances <span class="op">=</span> rf_model.feature_importances_</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize to sum to 100%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>normalized_rf_feature_importances <span class="op">=</span> (rf_feature_importances <span class="op">/</span> rf_feature_importances.<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame for better visualization</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>rf_feature_importances_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Feature'</span>: X.columns,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mean Decrease in Gini'</span>: rf_feature_importances,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Normalized Mean Decrease in Gini'</span>: normalized_rf_feature_importances</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>rf_feature_importances_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Mean Decrease in Gini</th>
<th data-quarto-table-cell-role="th">Normalized Mean Decrease in Gini</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>trust</td>
<td>0.155865</td>
<td>15.586537</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>build</td>
<td>0.102301</td>
<td>10.230144</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>differs</td>
<td>0.089897</td>
<td>8.989693</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>easy</td>
<td>0.099904</td>
<td>9.990365</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>appealing</td>
<td>0.085534</td>
<td>8.553448</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>rewarding</td>
<td>0.101057</td>
<td>10.105692</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>popular</td>
<td>0.094944</td>
<td>9.494376</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>service</td>
<td>0.129664</td>
<td>12.966365</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>impact</td>
<td>0.140834</td>
<td>14.083380</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Features with a higher Mean Decrease in Gini are more important in reducing impurity and improving model accuracy.</p>
<ul>
<li><strong>trust</strong> and <strong>impact</strong> are crucial in reducing Gini impurity, aligning with their high importance in previous metrics.</li>
<li><strong>service</strong> and <strong>build</strong> also contribute significantly.</li>
</ul>
</section>
<section id="feature-importance-from-xgboost" class="level3">
<h3 class="anchored" data-anchor-id="feature-importance-from-xgboost">Feature Importance from XGBoost</h3>
<p>XGBoost provides feature importances based on various metrics like gain, weight, and cover. We use the gain metric, which measures the improvement in accuracy brought by a feature to the branches it is on.</p>
<div id="3b3373b5" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit an XGBoost model</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>xgb_model <span class="op">=</span> xgb.XGBRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>xgb_model.fit(X, y)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get feature importances using the 'gain' metric</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>booster <span class="op">=</span> xgb_model.get_booster()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>importance_dict <span class="op">=</span> booster.get_score(importance_type<span class="op">=</span><span class="st">'gain'</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the importance dictionary to a DataFrame</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>xgb_importance_df <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(importance_dict.items()), columns<span class="op">=</span>[<span class="st">'Feature'</span>, <span class="st">'Importance'</span>])</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize to sum to 100%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>xgb_importance_df[<span class="st">'Normalized Importance'</span>] <span class="op">=</span> (xgb_importance_df[<span class="st">'Importance'</span>] <span class="op">/</span> xgb_importance_df[<span class="st">'Importance'</span>].<span class="bu">sum</span>()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>xgb_importance_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Importance</th>
<th data-quarto-table-cell-role="th">Normalized Importance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>trust</td>
<td>0.726525</td>
<td>28.986719</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>build</td>
<td>0.197839</td>
<td>7.893330</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>differs</td>
<td>0.141373</td>
<td>5.640452</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>easy</td>
<td>0.179203</td>
<td>7.149780</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>appealing</td>
<td>0.164887</td>
<td>6.578636</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>rewarding</td>
<td>0.163910</td>
<td>6.539633</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>popular</td>
<td>0.190827</td>
<td>7.613552</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>service</td>
<td>0.279030</td>
<td>11.132675</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>impact</td>
<td>0.462813</td>
<td>18.465223</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Features with higher gain contribute more to improving the model’s accuracy. * <strong>trust</strong> stands out as the most important feature, with a high gain value. * <strong>impact</strong> and <strong>service</strong> are also significant contributors.</p>
</section>
</section>
<section id="combined-analysis-and-conclusion" class="level2">
<h2 class="anchored" data-anchor-id="combined-analysis-and-conclusion">Combined Analysis and Conclusion</h2>
<div id="d0f0a3f5" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>final_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Feature'</span>: features,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Pearson Correlations'</span>: normalized_corr.values,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Standardized Regression Coefficient'</span>: normalized_coefficients,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Usefulness'</span>: usefulness_normalized,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Shapley Values'</span>: normalized_shap_values_manual,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Johnson</span><span class="ch">\'</span><span class="st">s Weights'</span>: relative_weights[<span class="st">'normRelaImpt'</span>].values,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mean Decrease in RF Gini Coefficient'</span>: normalized_rf_feature_importances, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'XGBoost Feature Importance'</span>: xgb_importance_df[<span class="st">'Normalized Importance'</span>]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>final_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Pearson Correlations</th>
<th data-quarto-table-cell-role="th">Standardized Regression Coefficient</th>
<th data-quarto-table-cell-role="th">Usefulness</th>
<th data-quarto-table-cell-role="th">Shapley Values</th>
<th data-quarto-table-cell-role="th">Johnson's Weights</th>
<th data-quarto-table-cell-role="th">Mean Decrease in RF Gini Coefficient</th>
<th data-quarto-table-cell-role="th">XGBoost Feature Importance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>trust</td>
<td>13.283356</td>
<td>25.280109</td>
<td>31.517391</td>
<td>19.547288</td>
<td>19.835524</td>
<td>15.586537</td>
<td>28.986719</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>build</td>
<td>9.968574</td>
<td>4.363461</td>
<td>1.016743</td>
<td>6.119831</td>
<td>6.620792</td>
<td>10.230144</td>
<td>7.893330</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>differs</td>
<td>9.600014</td>
<td>6.081798</td>
<td>2.104285</td>
<td>6.386692</td>
<td>6.966081</td>
<td>8.989693</td>
<td>5.640452</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>easy</td>
<td>11.064100</td>
<td>4.798205</td>
<td>1.103478</td>
<td>8.528979</td>
<td>8.239683</td>
<td>9.990365</td>
<td>7.149780</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>appealing</td>
<td>10.804975</td>
<td>7.389479</td>
<td>2.713117</td>
<td>9.139131</td>
<td>8.346395</td>
<td>8.553448</td>
<td>6.578636</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>rewarding</td>
<td>10.107052</td>
<td>1.106526</td>
<td>0.060194</td>
<td>6.767128</td>
<td>5.997431</td>
<td>10.105692</td>
<td>6.539633</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>popular</td>
<td>8.905177</td>
<td>3.628859</td>
<td>0.780849</td>
<td>5.234813</td>
<td>5.392328</td>
<td>9.494376</td>
<td>7.613552</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>service</td>
<td>13.044017</td>
<td>19.304269</td>
<td>17.869775</td>
<td>16.560666</td>
<td>16.635164</td>
<td>12.966365</td>
<td>11.132675</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>impact</td>
<td>13.222734</td>
<td>28.047294</td>
<td>42.834168</td>
<td>21.715472</td>
<td>21.966601</td>
<td>14.083380</td>
<td>18.465223</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this analysis, we explored various statistical methods to identify the key drivers of customer satisfaction in a payment card dataset. Each method provides unique insights into feature importance, helping us to understand which factors are most influential. By comparing these methods, we gain a comprehensive view of the factors driving customer satisfaction, enabling better decision-making and targeted improvements.</p>
<ul>
<li><strong>Trust</strong> consistently emerged as a significant driver across all metrics, indicating that building trust with customers is crucial for enhancing their satisfaction.</li>
<li><strong>Impact</strong> was also highlighted as a key factor, suggesting that customers value the positive influence the payment card has on their lives.</li>
<li><strong>Service</strong> and <strong>Ease of Use</strong> were important in several metrics, emphasizing the need for excellent customer service and user-friendly features.</li>
</ul>
<p>The combination of these methods provides a robust analysis, allowing us to cross-validate the importance of features and identify the most critical drivers of customer satisfaction. This multi-faceted approach can guide businesses in prioritizing areas for improvement and investment, ultimately leading to higher customer satisfaction and loyalty.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>